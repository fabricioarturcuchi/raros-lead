<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lead Consórcio - Envio para Google Sheets</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #111;
    color: #fff;
    max-width: 480px;
    margin: 40px auto;
    padding: 20px;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  select, input[type="text"], input[type="email"], input[type="tel"], input[type="number"] {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border-radius: 6px;
    border: none;
    font-size: 16px;
  }
  button {
    margin-top: 25px;
    background: #b38b00;
    border: none;
    color: #000;
    font-weight: 700;
    padding: 12px;
    font-size: 18px;
    border-radius: 8px;
    cursor: pointer;
    width: 100%;
  }
  button:hover {
    background: #d2af00;
  }
  .info {
    margin-top: 8px;
    color: #b38b00;
  }
  .error {
    color: #e55;
    margin-top: 8px;
  }
  .success {
    color: #6f6;
    margin-top: 8px;
  }
</style>
</head>
<body>

<h1>Consórcio - Solicite seu orçamento</h1>

<form id="formLead">

  <label for="tipoConsorcio">Tipo de Consórcio</label>
  <select id="tipoConsorcio" required>
    <option value="" disabled selected>-- Selecione --</option>
    <option value="Automovel">Automóvel</option>
    <option value="Imovel">Imóvel</option>
  </select>

  <label for="valorDesejado">Valor Desejado (R$)</label>
  <input type="number" id="valorDesejado" placeholder="Ex: 80000" min="0" required disabled />

  <div class="info" id="infoTaxaPrazo"></div>

  <label for="valorParcela">Valor da Parcela (R$)</label>
  <input type="number" id="valorParcela" placeholder="Ex: 1500" min="0" required disabled />

  <label for="nome">Nome Completo</label>
  <input type="text" id="nome" placeholder="Seu nome" required />

  <label for="telefone">Telefone</label>
  <input type="tel" id="telefone" placeholder="(XX) XXXXX-XXXX" required />

  <label for="email">E-mail</label>
  <input type="email" id="email" placeholder="seu@email.com" required />

  <button type="submit">Enviar</button>

  <div id="mensagem"></div>

</form>

<script>
  const tipoConsorcio = document.getElementById('tipoConsorcio');
  const valorDesejado = document.getElementById('valorDesejado');
  const valorParcela = document.getElementById('valorParcela');
  const infoTaxaPrazo = document.getElementById('infoTaxaPrazo');
  const form = document.getElementById('formLead');
  const mensagem = document.getElementById('mensagem');

  // Define limites e taxa conforme seleção
  tipoConsorcio.addEventListener('change', () => {
    mensagem.textContent = '';
    valorDesejado.value = '';
    valorParcela.value = '';
    valorDesejado.disabled = false;
    valorParcela.disabled = false;

    if (tipoConsorcio.value === 'Automovel') {
      valorDesejado.min = 65000;
      valorDesejado.max = 130000;
      infoTaxaPrazo.textContent = "Taxa Administrativa: 16% | Prazo máximo: 84 parcelas";
    } else if (tipoConsorcio.value === 'Imovel') {
      valorDesejado.min = 200000;
      valorDesejado.max = 500000;
      infoTaxaPrazo.textContent = "Taxa Administrativa: 22% | Prazo máximo: 220 parcelas";
    } else {
      valorDesejado.disabled = true;
      valorParcela.disabled = true;
      infoTaxaPrazo.textContent = '';
    }
  });

  form.addEventListener('submit', e => {
    e.preventDefault();
    mensagem.textContent = '';
    mensagem.className = '';

    // Validação básica dos valores
    const tipo = tipoConsorcio.value;
    const valorD = Number(valorDesejado.value);
    const valorP = Number(valorParcela.value);
    const nome = document.getElementById('nome').value.trim();
    const tel = document.getElementById('telefone').value.trim();
    const email = document.getElementById('email').value.trim();

    if (!tipo) {
      mensagem.textContent = 'Selecione o tipo de consórcio.';
      mensagem.className = 'error';
      return;
    }

    if (isNaN(valorD) || valorD < valorDesejado.min || valorD > valorDesejado.max) {
      mensagem.textContent = `Valor desejado deve estar entre R$ ${Number(valorDesejado.min).toLocaleString('pt-BR')} e R$ ${Number(valorDesejado.max).toLocaleString('pt-BR')}.`;
      mensagem.className = 'error';
      return;
    }

    if (isNaN(valorP) || valorP <= 0) {
      mensagem.textContent = 'Informe um valor válido para a parcela.';
      mensagem.className = 'error';
      return;
    }

    if (!nome || !tel || !email) {
      mensagem.textContent = 'Preencha todos os campos.';
      mensagem.className = 'error';
      return;
    }

    const dados = {
      tipoConsorcio: tipo,
      valorDesejado: valorD.toFixed(2),
      valorParcela: valorP.toFixed(2),
      nome: nome,
      telefone: tel,
      email: email
    };

    mensagem.textContent = 'Enviando...';
    mensagem.className = '';

    fetch('https://script.google.com/macros/s/AKfycbxKMwF8hwdj1HrLic5zqARMNZ95tA3C7AQFQlbQ24tJgWajaYB9avXWVwlLpv38i0o2DQ/exec', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(dados)
    })
    .then(response => response.json())
    .then(resp => {
      if (resp.result === 'success') {
        mensagem.textContent = 'Lead enviado com sucesso! Obrigado.';
        mensagem.className = 'success';
        form.reset();
        valorDesejado.disabled = true;
        valorParcela.disabled = true;
        infoTaxaPrazo.textContent = '';
      } else {
        mensagem.textContent = 'Erro ao enviar: ' + resp.message;
        mensagem.className = 'error';
      }
    })
    .catch(error => {
      mensagem.textContent = 'Erro na comunicação: ' + error.message;
      mensagem.className = 'error';
    });
  });
</script>

</body>
</html>
